(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ;b=a.encrypt2=a.encrypt2||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.Var$1=f.Var$1||{};h=d.Operators=d.Operators||{};i=f.HtmlModule=f.HtmlModule||{};j=i.attr=i.attr||{};k=f.Var=f.Var||{};l=a.EventTarget;m=a.WindowOrWorkerGlobalScope;n=d.JavaScript=d.JavaScript||{};o=n.JS=n.JS||{};p=f.ConcreteVar=f.ConcreteVar||{};q=f.Snap=f.Snap||{};r=d.List=d.List||{};s=d.Strings=d.Strings||{};t=f.AttrProxy=f.AttrProxy||{};u=f.Doc=f.Doc||{};v=n.Pervasives=n.Pervasives||{};w=d.Seq=d.Seq||{};x=r.T=r.T||{};y=d.Arrays=d.Arrays||{};z=d.Char=d.Char||{};A=f.Client=f.Client||{};B=A.Templates=A.Templates||{};C=f.Abbrev=f.Abbrev||{};D=C.Fresh=C.Fresh||{};E=a.StartupCode$encrypt2$Client=a.StartupCode$encrypt2$Client||{};F=f.Attrs=f.Attrs||{};G=f.DomUtility=f.DomUtility||{};H=f.View=f.View||{};I=f.AttrModule=f.AttrModule||{};J=d.Enumerator=d.Enumerator||{};K=J.T=J.T||{};L=a.Object;M=a.Node;N=d.Collections=d.Collections||{};O=N.Dictionary=N.Dictionary||{};P=d.Unchecked=d.Unchecked||{};Q=d.Numeric=d.Numeric||{};R=f.BindVar=f.BindVar||{};S=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};T=N.HashSet=N.HashSet||{};U=f.Docs=f.Docs||{};V=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};W=d.Random=d.Random||{};X=f.Elt=f.Elt||{};Y=f.Array=f.Array||{};Z=f.DocElemNode=f.DocElemNode||{};_0=a.CharacterData;_1=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};_2=N.DictionaryUtil=N.DictionaryUtil||{};_3=a.Element;_4=B.Prepare=B.Prepare||{};_5=d.Slice=d.Slice||{};_6=N.KeyCollection=N.KeyCollection||{};_7=f.An=f.An||{};_8=A.Settings=A.Settings||{};_9=C.Mailbox=C.Mailbox||{};_=f.Updates=f.Updates||{};$=A.Attrs=A.Attrs||{};ba=$.Dyn=$.Dyn||{};bb=f.String=f.String||{};bc=f.CheckedInput=f.CheckedInput||{};bd=A.Docs=A.Docs||{};be=bd.RunState=bd.RunState||{};bf=bd.NodeSet=bd.NodeSet||{};bg=d.Concurrency=d.Concurrency||{};bh=f.Anims=f.Anims||{};bi=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bj=f.DynamicAttrNode=f.DynamicAttrNode||{};bk=d.DateUtil=d.DateUtil||{};bl=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bm=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bn=f.AppendList=f.AppendList||{};bo=N.HashSetUtil=N.HashSetUtil||{};bp=a.Error;bq=d.KeyNotFoundException=d.KeyNotFoundException||{};br=bg.Scheduler=bg.Scheduler||{};bs=f.Easing=f.Easing||{};bt=bg.AsyncBody=bg.AsyncBody||{};bu=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bv=bg.CT=bg.CT||{};bw=C.HashSet=C.HashSet||{};bx=d.CancellationTokenSource=d.CancellationTokenSource||{};by=bd.DomNodes=bd.DomNodes||{};bz=d.OperationCanceledException=d.OperationCanceledException||{};bA=d.Lazy=d.Lazy||{};bB=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bC=d.Queue=d.Queue||{};bD=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bE=bD.LazyRecord=bD.LazyRecord||{};bF=a.String;bG=d&&d.Runtime;bH=a.console;bI=a.Math;bJ=a.Date;c.Main=function(){var bK,bL,bM,bN,bO;bK=g.Create$1("");bL=g.Create$1("");bM=g.Create$1("");bN=g.Create$1(c.displayKey());bO=u.Element("div",[t.Create("class","auth-container")],[u.Element("h1",[],[u.TextNode("Encryption App")]),u.Element("div",[t.Create("class","form-group")],[u.Element("h3",[],[u.TextNode("Encrypt a Message")]),u.Input([t.Create("class","form-control")],bK),u.Element("button",[t.Create("class","btn btn-default"),t.HandlerImpl("click",function(){return function(){return bL.Set(c.encrypt(bK.Get()));};})],[u.TextNode("Encrypt")]),u.Element("button",[t.Create("class","btn btn-default"),t.HandlerImpl("click",function(){return function(){return bL.Set(c.reverseEncrypt(bK.Get()));};})],[u.TextNode("Reverse Encrypt")]),u.Element("button",[t.Create("class","btn btn-default"),t.HandlerImpl("click",function(){return function(){return bL.Set(c.caseSensitiveEncrypt(bK.Get()));};})],[u.TextNode("Case-Sensitive Encrypt")])]),u.Element("div",[t.Create("class","form-group")],[u.Element("h3",[],[u.TextNode("Encrypted Message")]),u.Input([t.Create("class","form-control"),t.Create("readonly","readonly")],bL)]),u.Element("div",[t.Create("class","form-group")],[u.Element("h3",[],[u.TextNode("Decrypt the Message")]),u.Input([t.Create("class","form-control")],bL),u.Element("button",[t.Create("class","btn btn-default"),t.HandlerImpl("click",function(){return function(){return bM.Set(c.decrypt(bL.Get()));};})],[u.TextNode("Decrypt")])]),u.Element("div",[t.Create("class","form-group")],[u.Element("h3",[],[u.TextNode("Decrypted Message")]),u.Input([t.Create("class","form-control"),t.Create("readonly","readonly")],bM)]),u.Element("div",[t.Create("class","form-group")],[u.Element("h3",[],[u.TextNode("Encryption Key")]),u.Input([t.Create("class","form-control"),t.Create("readonly","readonly")],bN),u.Element("button",[t.Create("class","btn btn-default"),t.HandlerImpl("click",function(){return function(){return bN.Set(c.saveKey());};})],[u.TextNode("Save Key")]),u.Element("button",[t.Create("class","btn btn-default"),t.HandlerImpl("click",function(){return function(){var bP;bP=self.prompt("Enter the encryption key:");return!s.IsNullOrWhiteSpace(bP)?(c.loadKey(bP),bN.Set(c.displayKey())):null;};})],[u.TextNode("Load Key")])])]);B.LoadLocalTemplates("");u.RunById("main",bO);};c.displayKey=function(){return s.concat("",r.map(a.id,c.keyList()));};c.encrypt=function(bK){return s.concat("",y.map(a.id,y.ofSeq(w.map(function(bL){var bM;bM=w.findIndex(function(bN){return bL===bN;},c.charsList());return c.keyList().get_Item(bM);},bK))));};c.reverseEncrypt=function(bK){return c.encrypt(y.ofSeq(w.rev(bK)).join(""));};c.caseSensitiveEncrypt=function(bK){return s.concat("",y.map(a.id,y.ofSeq(w.map(function(bL){var bM,bN,bO;return z.IsUpper(bL)?(bM=bF.fromCharCode(bL).toLowerCase().charCodeAt(0),(bN=w.findIndex(function(bP){return bM===bP;},c.charsList()),bF.fromCharCode(c.keyList().get_Item(bN)).toUpperCase().charCodeAt(0))):(bO=w.findIndex(function(bP){return bL===bP;},c.charsList()),c.keyList().get_Item(bO));},bK))));};c.decrypt=function(bK){return s.concat("",y.map(a.id,y.ofSeq(w.map(function(bL){var bM;bM=w.findIndex(function(bN){return bL===bN;},c.keyList());return c.charsList().get_Item(bM);},bK))));};c.saveKey=function(){return c.displayKey();};c.loadKey=function(bK){var bL;function bM(bN,bO){return function(bP){return[r.append(bN,r.ofArray([bP[0]])),r.append(bO,r.ofArray([bP[1]]))];};}bL=w.fold(function(bN,bO){return(function(bP){return bM(bP[0],bP[1]);}(bN))(bO);},[x.Empty,x.Empty],r.mapi(function(bN,bO){return[c.charsList().get_Item(bN),bO];},r.ofSeq(w.map(a.id,bK))));c.set_charsList(bL[0]);c.set_keyList(bL[1]);};c.keyList=function(){E.$cctor();return E.keyList;};c.charsList=function(){E.$cctor();return E.charsList;};c.set_charsList=function(bK){E.$cctor();E.charsList=bK;};c.set_keyList=function(bK){E.$cctor();E.keyList=bK;};c.shuffle=function(bK){var bL,bM,bN,bO,bP,bQ;bL=new W.New();bM=y.ofList(bK);for(bN=0,bO=y.length(bM)-1;bN<=bO;bN++){bP=bL.Next$1(y.length(bM));bQ=y.get(bM,bN);y.set(bM,bN,y.get(bM,bP));y.set(bM,bP,bQ);}return r.ofArray(bM);};e=d.Obj=bG.Class({Equals:function(bK){return this===bK;},GetHashCode:function(){return -1;}},null,e);e.New=bG.Ctor(function(){},e);g=f.Var$1=bG.Class({},e,g);g.Create$1=function(bK){return new p.New(false,q.New({$:2,$0:bK,$1:[]}),bK);};h.FailWith=function(bK){throw new bp(bK);};h.range=function(bK,bL){var bM;bM=1+bL-bK;return bM<=0?[]:w.init(bM,function(bN){return bN+bK;});};h.KeyValue=function(bK){return[bK.K,bK.V];};j=i.attr=bG.Class({},e,j);k=f.Var=bG.Class({},e,k);k.New=bG.Ctor(function(){e.New.call(this);},k);o.GetFieldValues=function(bK){var bL,bM;bL=[];for(var bN in bK)bL.push(bK[bN]);return bL;};p=f.ConcreteVar=bG.Class({Set:function(bK){if(this.isConst)(function(bL){return bL("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bL){bH.log(bL);}));else{q.Obsolete(this.snap);this.current=bK;this.snap=q.New({$:2,$0:bK,$1:[]});}},Get:function(){return this.current;},get_View:function(){return this.view;},UpdateMaybe:function(bK){var bL;bL=bK(this.Get());if(bL!=null&&bL.$==1)this.Set(bL.$0);}},k,p);p.New=bG.Ctor(function(bK,bL,bM){var bN;bN=this;k.New.call(this);this.isConst=bK;this.current=bM;this.snap=bL;this.view=function(){return bN.snap;};this.id=D.Int();},p);q.WhenRun=function(bK,bL,bM){var bN;bN=bK.s;if(bN==null)bM();else bN!=null&&bN.$==2?(bN.$1.push(bM),bL(bN.$0)):bN!=null&&bN.$==3?(bN.$0.push(bL),bN.$1.push(bM)):bL(bN.$0);};q.Copy=function(bK){var bL,bM,bN;bL=bK.s;return bL==null?bK:bL!=null&&bL.$==2?(bM=q.New({$:2,$0:bL.$0,$1:[]}),(q.WhenObsolete(bK,bM),bM)):bL!=null&&bL.$==3?(bN=q.New({$:3,$0:[],$1:[]}),(q.When(bK,function(bO){q.MarkDone(bN,bK,bO);},bN),bN)):bK;};q.WhenObsoleteRun=function(bK,bL){var bM;bM=bK.s;if(bM==null)bL();else bM!=null&&bM.$==2?bM.$1.push(bL):bM!=null&&bM.$==3?bM.$1.push(bL):void 0;};q.Map2Unit=function(bK,bL){var bM,bN,bO;function bP(){var bQ,bR,bS;if(!(bQ=bO.s,bQ!=null&&bQ.$==0||bQ!=null&&bQ.$==2)){bR=q.ValueAndForever(bK);bS=q.ValueAndForever(bL);if(bR!=null&&bR.$==1)bS!=null&&bS.$==1?bR.$0[1]&&bS.$0[1]?q.MarkForever(bO,null):q.MarkReady(bO,null):void 0;}}bM=bK.s;bN=bL.s;return bM!=null&&bM.$==0?bN!=null&&bN.$==0?q.New({$:0,$0:null}):bL:bN!=null&&bN.$==0?bK:(bO=q.New({$:3,$0:[],$1:[]}),(q.When(bK,bP,bO),q.When(bL,bP,bO),bO));};q.WhenObsolete=function(bK,bL){var bM;bM=bK.s;if(bM==null)q.Obsolete(bL);else bM!=null&&bM.$==2?q.EnqueueSafe(bM.$1,bL):bM!=null&&bM.$==3?q.EnqueueSafe(bM.$1,bL):void 0;};q.When=function(bK,bL,bM){var bN;bN=bK.s;if(bN==null)q.Obsolete(bM);else bN!=null&&bN.$==2?(q.EnqueueSafe(bN.$1,bM),bL(bN.$0)):bN!=null&&bN.$==3?(bN.$0.push(bL),q.EnqueueSafe(bN.$1,bM)):bL(bN.$0);};q.MarkDone=function(bK,bL,bM){var bN;if(bN=bL.s,bN!=null&&bN.$==0)q.MarkForever(bK,bM);else q.MarkReady(bK,bM);};q.ValueAndForever=function(bK){var bL;bL=bK.s;return bL!=null&&bL.$==0?{$:1,$0:[bL.$0,true]}:bL!=null&&bL.$==2?{$:1,$0:[bL.$0,false]}:null;};q.MarkForever=function(bK,bL){var bM,bN,bO,bP;bM=bK.s;if(bM!=null&&bM.$==3){bK.s={$:0,$0:bL};bN=bM.$0;for(bO=0,bP=y.length(bN)-1;bO<=bP;bO++)(y.get(bN,bO))(bL);}else void 0;};q.MarkReady=function(bK,bL){var bM,bN,bO,bP;bM=bK.s;if(bM!=null&&bM.$==3){bK.s={$:2,$0:bL,$1:bM.$1};bN=bM.$0;for(bO=0,bP=y.length(bN)-1;bO<=bP;bO++)(y.get(bN,bO))(bL);}else void 0;};q.Map=function(bK,bL){var bM,bN;bM=bL.s;return bM!=null&&bM.$==0?q.New({$:0,$0:bK(bM.$0)}):(bN=q.New({$:3,$0:[],$1:[]}),(q.When(bL,function(bO){q.MarkDone(bN,bL,bK(bO));},bN),bN));};q.EnqueueSafe=function(bK,bL){var bM,bN,bO,bP;bK.push(bL);if(bK.length%20===0){bM=bK.slice(0);bC.Clear(bK);for(bN=0,bO=y.length(bM)-1;bN<=bO;bN++){bP=y.get(bM,bN);if(typeof bP=="object")(function(bQ){if(bQ.s)bK.push(bQ);}(bP));else(function(bQ){bK.push(bQ);}(bP));}}else void 0;};r.map=function(bK,bL){var bM,bN,bO,bP,bQ;if(bL.$==0)return bL;else{bP=new x({$:1});bM=bP;bN=bL;bO=true;while(bO){bM.$0=bK(bN.$0);bN=bN.$1;if(bN.$==0)bO=false;else bM=(bQ=new x({$:1}),bM.$1=bQ,bQ);}bM.$1=x.Empty;return bP;}};r.ofSeq=function(bK){var bL,bM,bN,bO,bP,bQ;if(bK instanceof x)return bK;else if(bK instanceof a.Array)return r.ofArray(bK);else{bL=J.Get(bK);try{bN=bL.MoveNext();if(!bN)bM=x.Empty;else{bP=new x({$:1});bO=bP;while(bN){bO.$0=bL.Current();if(bL.MoveNext())bO=(bQ=new x({$:1}),bO.$1=bQ,bQ);else bN=false;}bO.$1=x.Empty;bM=bP;}return bM;}finally{if(typeof bL=="object"&&"Dispose"in bL)bL.Dispose();}}};r.mapi=function(bK,bL){var bM,bN,bO,bP,bQ,bR;if(bL.$==0)return bL;else{bQ=new x({$:1});bM=bQ;bN=bL;bO=0;bP=true;while(bP){bM.$0=bK(bO,bN.$0);bN=bN.$1;if(bN.$==0)bP=false;else{bM=(bR=new x({$:1}),bM.$1=bR,bR);bO=bO+1;}}bM.$1=x.Empty;return bQ;}};r.ofArray=function(bK){var bL,bM,bN;bL=x.Empty;for(bM=y.length(bK)-1,bN=0;bM>=bN;bM--)bL=new x({$:1,$0:y.get(bK,bM),$1:bL});return bL;};r.append=function(bK,bL){var bM,bN,bO,bP,bQ;if(bK.$==0)return bL;else if(bL.$==0)return bK;else{bP=new x({$:1});bM=bP;bN=bK;bO=true;while(bO){bM.$0=bN.$0;bN=bN.$1;if(bN.$==0)bO=false;else bM=(bQ=new x({$:1}),bM.$1=bQ,bQ);}bM.$1=bL;return bP;}};r.head=function(bK){return bK.$==1?bK.$0:r.listEmpty();};r.tail=function(bK){return bK.$==1?bK.$1:r.listEmpty();};r.listEmpty=function(){return h.FailWith("The input list was empty.");};s.concat=function(bK,bL){return y.ofSeq(bL).join(bK);};s.IsNullOrWhiteSpace=function(bK){return bK==null||(new a.RegExp("^\\s*$")).test(bK);};s.SplitChars=function(bK,bL,bM){return s.Split(bK,new a.RegExp("["+s.RegexEscape(bL.join(""))+"]"),bM);};s.StartsWith=function(bK,bL){return bK.substring(0,bL.length)==bL;};s.forall=function(bK,bL){return w.forall(bK,s.protect(bL));};s.Split=function(bK,bL,bM){return bM===1?y.filter(function(bN){return bN!=="";},s.SplitWith(bK,bL)):s.SplitWith(bK,bL);};s.RegexEscape=function(bK){return bK.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};s.protect=function(bK){return bK==null?"":bK;};s.SplitWith=function(bK,bL){return bK.split(bL);};t=f.AttrProxy=bG.Class({},null,t);t.Create=function(bK,bL){return F.Static(function(bM){bM.setAttribute(bK,bL);});};t.HandlerImpl=function(bK,bL){return F.Static(function(bM){bM.addEventListener(bK,function(bN){return(bL(bM))(bN);},false);});};t.Concat=function(bK){var bL;bL=Y.ofSeqNonCopying(bK);return Y.TreeReduce(F.EmptyAttr(),t.Append,bL);};t.Append=function(bK,bL){return F.AppendTree(bK,bL);};u=f.Doc=bG.Class({},e,u);u.TextNode=function(bK){return u.Mk({$:5,$0:self.document.createTextNode(bK)},H.Const());};u.Input=function(bK,bL){return u.InputInternal("input",function(){return w.append(bK,[I.Value(bL)]);});};u.RunById=function(bK,bL){var bM;bM=self.document.getElementById(bK);if(P.Equals(bM,null))h.FailWith("invalid id: "+bK);else u.Run(bM,bL);};u.Element=function(bK,bL,bM){var bN,bO;bN=t.Concat(bL);bO=u.Concat(bM);return X.New(self.document.createElement(bK),bN,bO);};u.Mk=function(bK,bL){return new u.New(bK,bL);};u.InputInternal=function(bK,bL){var bM;bM=self.document.createElement(bK);return X.New(bM,t.Concat(bL(bM)),u.get_Empty());};u.Run=function(bK,bL){U.LinkElement(bK,bL.docNode);u.RunInPlace(false,bK,bL);};u.Concat=function(bK){var bL;bL=Y.ofSeqNonCopying(bK);return Y.TreeReduce(u.get_Empty(),u.Append,bL);};u.get_Empty=function(){return u.Mk(null,H.Const());};u.RunInPlace=function(bK,bL,bM){var bN;bN=U.CreateRunState(bL,bM.docNode);H.Sink(_7.get_UseAnimations()||_8.BatchUpdatesEnabled()?_9.StartProcessor(U.PerformAnimatedUpdate(bK,bN,bM.docNode)):function(){U.PerformSyncUpdate(bK,bN,bM.docNode);},bM.updates);};u.Append=function(bK,bL){return u.Mk({$:0,$0:bK.docNode,$1:bL.docNode},H.Map2Unit(bK.updates,bL.updates));};u.New=bG.Ctor(function(bK,bL){e.New.call(this);this.docNode=bK;this.updates=bL;},u);v.NewFromSeq=function(bK){var bL,bM,bN;bL={};bM=J.Get(bK);try{while(bM.MoveNext()){bN=bM.Current();bL[bN[0]]=bN[1];}}finally{if(typeof bM=="object"&&"Dispose"in bM)bM.Dispose();}return bL;};w.map=function(bK,bL){return{GetEnumerator:function(){var bM;bM=J.Get(bL);return new K.New(null,null,function(bN){return bM.MoveNext()&&(bN.c=bK(bM.Current()),true);},function(){bM.Dispose();});}};};w.rev=function(bK){return w.delay(function(){return y.ofSeq(bK).slice().reverse();});};w.append=function(bK,bL){return{GetEnumerator:function(){var bM,bN;bM=J.Get(bK);bN=[true];return new K.New(bM,null,function(bO){var bP;return bO.s.MoveNext()?(bO.c=bO.s.Current(),true):(bP=bO.s,!P.Equals(bP,null)?bP.Dispose():void 0,bO.s=null,bN[0]&&(bN[0]=false,bO.s=J.Get(bL),bO.s.MoveNext()?(bO.c=bO.s.Current(),true):(bO.s.Dispose(),bO.s=null,false)));},function(bO){var bP;bP=bO.s;if(!P.Equals(bP,null))bP.Dispose();});}};};w.findIndex=function(bK,bL){var bM;bM=w.tryFindIndex(bK,bL);return bM==null?h.FailWith("KeyNotFoundException"):bM.$0;};w.delay=function(bK){return{GetEnumerator:function(){return J.Get(bK());}};};w.fold=function(bK,bL,bM){var bN,bO;bN=bL;bO=J.Get(bM);try{while(bO.MoveNext())bN=bK(bN,bO.Current());return bN;}finally{if(typeof bO=="object"&&"Dispose"in bO)bO.Dispose();}};w.tryFindIndex=function(bK,bL){var bM,bN,bO;bM=J.Get(bL);try{bN=true;bO=0;while(bN&&bM.MoveNext())if(bK(bM.Current()))bN=false;else bO=bO+1;return bN?null:{$:1,$0:bO};}finally{if(typeof bM=="object"&&"Dispose"in bM)bM.Dispose();}};w.head=function(bK){var bL;bL=J.Get(bK);try{return bL.MoveNext()?bL.Current():w.insufficient();}finally{if(typeof bL=="object"&&"Dispose"in bL)bL.Dispose();}};w.init=function(bK,bL){return w.take(bK,w.initInfinite(bL));};w.nth=function(bK,bL){var bM,bN;if(bK<0)h.FailWith("negative index requested");bM=-1;bN=J.Get(bL);try{while(bM<bK){!bN.MoveNext()?w.insufficient():void 0;bM=bM+1;}return bN.Current();}finally{if(typeof bN=="object"&&"Dispose"in bN)bN.Dispose();}};w.take=function(bK,bL){bK<0?w.nonNegative():void 0;return{GetEnumerator:function(){var bM;bM=[J.Get(bL)];return new K.New(0,null,function(bN){var bO;bN.s=bN.s+1;return bN.s>bK?false:(bO=bM[0],P.Equals(bO,null)?w.insufficient():bO.MoveNext()?(bN.c=bO.Current(),bN.s===bK?(bO.Dispose(),bM[0]=null):void 0,true):(bO.Dispose(),bM[0]=null,w.insufficient()));},function(){var bN;bN=bM[0];if(!P.Equals(bN,null))bN.Dispose();});}};};w.initInfinite=function(bK){return{GetEnumerator:function(){return new K.New(0,null,function(bL){bL.c=bK(bL.s);bL.s=bL.s+1;return true;},void 0);}};};w.iter=function(bK,bL){var bM;bM=J.Get(bL);try{while(bM.MoveNext())bK(bM.Current());}finally{if(typeof bM=="object"&&"Dispose"in bM)bM.Dispose();}};w.forall=function(bK,bL){return!w.exists(function(bM){return!bK(bM);},bL);};w.exists=function(bK,bL){var bM,bN;bM=J.Get(bL);try{bN=false;while(!bN&&bM.MoveNext())bN=bK(bM.Current());return bN;}finally{if(typeof bM=="object"&&"Dispose"in bM)bM.Dispose();}};w.max=function(bK){var bL,bM,bN;bL=J.Get(bK);try{if(!bL.MoveNext())w.seqEmpty();bM=bL.Current();while(bL.MoveNext()){bN=bL.Current();if(P.Compare(bN,bM)===1)bM=bN;}return bM;}finally{if(typeof bL=="object"&&"Dispose"in bL)bL.Dispose();}};w.seqEmpty=function(){return h.FailWith("The input sequence was empty.");};x=r.T=bG.Class({get_Item:function(bK){return w.nth(bK,this);},GetEnumerator:function(){return new K.New(this,null,function(bK){var bL;bL=bK.s;return bL.$==0?false:(bK.c=bL.$0,bK.s=bL.$1,true);},void 0);}},null,x);x.Empty=new x({$:0});y.map=function(bK,bL){var bM,bN,bO;bM=new a.Array(bL.length);for(bN=0,bO=bL.length-1;bN<=bO;bN++)bM[bN]=bK(bL[bN]);return bM;};y.ofSeq=function(bK){var bL,bM;if(bK instanceof a.Array)return bK.slice();else if(bK instanceof x)return y.ofList(bK);else{bL=[];bM=J.Get(bK);try{while(bM.MoveNext())bL.push(bM.Current());return bL;}finally{if(typeof bM=="object"&&"Dispose"in bM)bM.Dispose();}}};y.ofList=function(bK){var bL,bM;bM=[];bL=bK;while(!(bL.$==0)){bM.push(r.head(bL));bL=r.tail(bL);}return bM;};y.exists=function(bK,bL){var bM,bN,bO,bP;bM=false;bN=0;bP=y.length(bL);while(!bM&&bN<bP)if(bK(bL[bN]))bM=true;else bN=bN+1;return bM;};y.tryPick=function(bK,bL){var bM,bN,bO;bM=null;bN=0;while(bN<bL.length&&bM==null){bO=bK(bL[bN]);if(bO!=null&&bO.$==1)bM=bO;bN=bN+1;}return bM;};y.tryFindIndex=function(bK,bL){var bM,bN;bM=null;bN=0;while(bN<bL.length&&bM==null){bK(bL[bN])?bM={$:1,$0:bN}:void 0;bN=bN+1;}return bM;};y.filter=function(bK,bL){var bM,bN,bO;bM=[];for(bN=0,bO=bL.length-1;bN<=bO;bN++)if(bK(bL[bN]))bM.push(bL[bN]);return bM;};y.iter=function(bK,bL){var bM,bN;for(bM=0,bN=bL.length-1;bM<=bN;bM++)bK(bL[bM]);};y.foldBack=function(bK,bL,bM){var bN,bO,bP,bQ,bR;bN=bM;bP=bL.length;for(bQ=1,bR=bP;bQ<=bR;bQ++)bN=bK(bL[bP-bQ],bN);return bN;};y.concat=function(bK){return a.Array.prototype.concat.apply([],y.ofSeq(bK));};y.pick=function(bK,bL){var bM;bM=y.tryPick(bK,bL);return bM==null?h.FailWith("KeyNotFoundException"):bM.$0;};y.choose=function(bK,bL){var bM,bN,bO,bP;bM=[];for(bN=0,bO=bL.length-1;bN<=bO;bN++){bP=bK(bL[bN]);if(bP==null);else bM.push(bP.$0);}return bM;};y.create=function(bK,bL){var bM,bN,bO;bM=new a.Array(bK);for(bN=0,bO=bK-1;bN<=bO;bN++)bM[bN]=bL;return bM;};y.init=function(bK,bL){var bM,bN,bO;if(bK<0)h.FailWith("Negative size given.");else null;bM=new a.Array(bK);for(bN=0,bO=bK-1;bN<=bO;bN++)bM[bN]=bL(bN);return bM;};y.forall=function(bK,bL){var bM,bN,bO,bP;bM=true;bN=0;bP=y.length(bL);while(bM&&bN<bP)if(bK(bL[bN]))bN=bN+1;else bM=false;return bM;};z.IsUpper=function(bK){return bK>="A"&&bK<="Z";};z.IsWhiteSpace=function(bK){return bK.match(new a.RegExp("\\s"))!==null;};B.LoadLocalTemplates=function(bK){!B.LocalTemplatesLoaded()?(B.set_LocalTemplatesLoaded(true),B.LoadNestedTemplates(self.document.body,"")):void 0;B.LoadedTemplates().set_Item(bK,B.LoadedTemplateFile(""));};B.LocalTemplatesLoaded=function(){S.$cctor();return S.LocalTemplatesLoaded;};B.set_LocalTemplatesLoaded=function(bK){S.$cctor();S.LocalTemplatesLoaded=bK;};B.LoadNestedTemplates=function(bK,bL){var bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7;function bM(b8){var b9,b_;if(!bN.ContainsKey(b8)){b9=(b_=null,[bO.TryGetValue(b8,{get:function(){return b_;},set:function(b$){b_=b$;}}),b_]);if(b9[0]){b7.SAdd(b8);bO.RemoveKey(b8);B.PrepareTemplateStrict(bL,{$:1,$0:b8},b9[1],{$:1,$0:bM});}else bH.warn(b7.Contains(b8)?"Encountered loop when instantiating "+b8:"Local template does not exist: "+b8);}}bN=B.LoadedTemplateFile(bL);bO=new O.New$5();bP=bK.querySelectorAll("[ws-template]");for(bQ=0,bR=bP.length-1;bQ<=bR;bQ++){bS=bP[bQ];bT=bS.getAttribute("ws-template").toLowerCase();bS.removeAttribute("ws-template");bO.set_Item(bT,B.FakeRootSingle(bS));}bU=bK.querySelectorAll("[ws-children-template]");for(bV=0,bW=bU.length-1;bV<=bW;bV++){bX=bU[bV];bY=bX.getAttribute("ws-children-template").toLowerCase();bX.removeAttribute("ws-children-template");bO.set_Item(bY,B.FakeRoot(bX));}bZ=bK.querySelectorAll("template[id]");for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];bO.set_Item(b2.getAttribute("id").toLowerCase(),B.FakeRootFromHTMLTemplate(b2));}b3=bK.querySelectorAll("template[name]");for(b4=0,b5=b3.length-1;b4<=b5;b4++){b6=b3[b4];bO.set_Item(b6.getAttribute("name").toLowerCase(),B.FakeRootFromHTMLTemplate(b6));}b7=new T.New$3();while(bO.count>0)bM(w.head(bO.Keys()));};B.LoadedTemplates=function(){S.$cctor();return S.LoadedTemplates;};B.LoadedTemplateFile=function(bK){var bL,bM,bN;bL=(bM=null,[B.LoadedTemplates().TryGetValue(bK,{get:function(){return bM;},set:function(bO){bM=bO;}}),bM]);return bL[0]?bL[1]:(bN=new O.New$5(),(B.LoadedTemplates().set_Item(bK,bN),bN));};B.FakeRootSingle=function(bK){var bL,bM,bN,bO;bK.removeAttribute("ws-template");bL=bK.getAttribute("ws-replace");if(bL==null);else{bK.removeAttribute("ws-replace");bM=bK.parentNode;P.Equals(bM,null)?void 0:(bN=self.document.createElement(bK.tagName),bN.setAttribute("ws-replace",bL),bM.replaceChild(bN,bK));}bO=self.document.createElement("div");bO.appendChild(bK);return bO;};B.FakeRoot=function(bK){var bL;bL=self.document.createElement("div");while(bK.hasChildNodes())bL.appendChild(bK.firstChild);return bL;};B.FakeRootFromHTMLTemplate=function(bK){var bL,bM,bN,bO;bL=self.document.createElement("div");bM=bK.content;for(bN=0,bO=bM.childNodes.length-1;bN<=bO;bN++)bL.appendChild(bM.childNodes[bN].cloneNode(true));return bL;};B.PrepareTemplateStrict=function(bK,bL,bM,bN){var bO,bP;function bQ(bW,bX){var bY,bZ,b0,b1,b2,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm;function b3(cn){}while(true)switch(bW){case 0:if(bX!==null){bY=bX.nextSibling;if(P.Equals(bX.nodeType,M.TEXT_NODE))_4.convertTextNode(bX);else if(P.Equals(bX.nodeType,M.ELEMENT_NODE))bS(bX);bX=bY;}else return null;break;case 1:b4=_5.string(bX.nodeName,{$:1,$0:3},null).toLowerCase();b5=(bZ=b4.indexOf("."),bZ===-1?[bK,b4]:[_5.string(b4,null,{$:1,$0:bZ-1}),_5.string(b4,{$:1,$0:bZ+1},null)]);b6=b5[1];b7=b5[0];if(b7!=""&&!B.LoadedTemplates().ContainsKey(b7))return _4.failNotLoaded(b6);else{if(b7==""&&bN!=null)bN.$0(b6);b8=B.LoadedTemplates().Item(b7);if(!b8.ContainsKey(b6))return _4.failNotLoaded(b6);else{b9=b8.Item(b6);b_=b9.cloneNode(true);b$=new T.New$3();ca=new O.New$5();cb=bX.attributes;for(cc=0,cd=cb.length-1;cc<=cd;cc++){ce=cb.item(cc).name.toLowerCase();ca.set_Item(ce,(cf=cb.item(cc).nodeValue,cf==""?ce:cf.toLowerCase()));if(!b$.SAdd(ce))bH.warn("Hole mapped twice",ce);}for(cg=0,ch=bX.childNodes.length-1;cg<=ch;cg++){ci=bX.childNodes[cg];if(P.Equals(ci.nodeType,M.ELEMENT_NODE))!b$.SAdd(ci.nodeName.toLowerCase())?bH.warn("Hole filled twice",b6):void 0;}cj=bX.childNodes.length===1&&P.Equals(bX.firstChild.nodeType,M.TEXT_NODE);if(cj){b1=_4.fillTextHole(b_,bX.firstChild.textContent,b6);((function(cn){return function(co){if(co!=null)cn(co.$0);};}((b2=function(cn){return function(co){return cn.SAdd(co);};}(b$),function(cn){return b3(b2(cn));})))(b1));}_4.removeHolesExcept(b_,b$);if(!cj){for(ck=0,cl=bX.childNodes.length-1;ck<=cl;ck++){cm=bX.childNodes[ck];if(P.Equals(cm.nodeType,M.ELEMENT_NODE))cm.hasAttributes()?_4.fillInstanceAttrs(b_,cm):bR(b_,cm);}}_4.mapHoles(b_,ca);_4.fill(b_,bX.parentNode,bX);bX.parentNode.removeChild(bX);return;}}break;}}function bR(bW,bX){var bY,bZ,b1,b2;function b0(b3,b4){var b5;if(b1=="title"&&bX.hasChildNodes()){b5=G.ParseHTMLIntoFakeRoot(bX.textContent);bX.removeChild(bX.firstChild);while(b5.hasChildNodes())bX.appendChild(b5.firstChild);}else null;bS(bX);return _4.fill(bX,b3,b4);}b1=bX.nodeName.toLowerCase();B.foreachNotPreserved(bW,"[ws-attr-holes]",function(b3){var b4,b5,b6,b7,b8;b4=s.SplitChars(b3.getAttribute("ws-attr-holes"),[" "],1);for(b5=0,b6=b4.length-1;b5<=b6;b5++){b7=y.get(b4,b5);b3.setAttribute(b7,(b8=new a.RegExp("\\${"+b1+"}","ig"),b3.getAttribute(b7).replace(b8,bX.textContent)));}});b2=bW.querySelector("[ws-hole="+b1+"]");if(P.Equals(b2,null)){bY=bW.querySelector("[ws-replace="+b1+"]");return P.Equals(bY,null)?(bZ=bW.querySelector("slot[name="+b1+"]"),bW.tagName.toLowerCase()=="template"?(b0(bZ.parentNode,bZ),void bZ.parentNode.removeChild(bZ)):null):(b0(bY.parentNode,bY),void bY.parentNode.removeChild(bY));}else{while(b2.hasChildNodes())b2.removeChild(b2.lastChild);b2.removeAttribute("ws-hole");return b0(b2,null);}}function bS(bW){if(!bW.hasAttribute("ws-preserve"))if(s.StartsWith(bW.nodeName.toLowerCase(),"ws-"))bU(bW);else{_4.convertAttrs(bW);bT(bW.firstChild);}}function bT(bW){return bQ(0,bW);}function bU(bW){return bQ(1,bW);}function bV(bW){var bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8;while(true){bX=bW.querySelector("[ws-template]");if(P.Equals(bX,null)){bY=bW.querySelector("[ws-children-template]");if(P.Equals(bY,null)){bZ=bW.querySelectorAll("template[id]");for(b0=1,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];if(bO.Contains(b2));else{B.PrepareTemplateStrict(bK,{$:1,$0:b2.getAttribute("id")},b2,null);bO.SAdd(b2);}}b3=bW.querySelectorAll("template[name]");for(b4=1,b5=b3.length-1;b4<=b5;b4++){b6=b3[b4];if(bO.Contains(b6));else{B.PrepareTemplateStrict(bK,{$:1,$0:b6.getAttribute("name")},b6,null);bO.SAdd(b6);}}return null;}else{b7=bY.getAttribute("ws-children-template");bY.removeAttribute("ws-children-template");B.PrepareTemplateStrict(bK,{$:1,$0:b7},bY,null);bW=bW;}}else{b8=bX.getAttribute("ws-template");(B.PrepareSingleTemplate(bK,{$:1,$0:b8},bX))(null);bW=bW;}}}bO=new T.New$3();bP=(bL==null?"":bL.$0).toLowerCase();B.LoadedTemplateFile(bK).set_Item(bP,bM);if(bM.hasChildNodes()){bV(bM);bT(bM.firstChild);}};B.foreachNotPreserved=function(bK,bL,bM){G.IterSelector(bK,bL,function(bN){if(bN.closest("[ws-preserve]")==null)bM(bN);});};B.PrepareSingleTemplate=function(bK,bL,bM){var bN;bN=B.FakeRootSingle(bM);return function(bO){B.PrepareTemplateStrict(bK,bL,bN,bO);};};B.TextHoleRE=function(){S.$cctor();return S.TextHoleRE;};D.Int=function(){D.set_counter(D.counter()+1);return D.counter();};D.set_counter=function(bK){V.$cctor();V.counter=bK;};D.counter=function(){V.$cctor();return V.counter;};E.$cctor=function(){E.$cctor=a.ignore;E.charsList=r.ofSeq(w.delay(function(){return w.map(bF.fromCharCode,h.range(32,126));}));E.keyList=c.shuffle(c.charsList());};F.Static=function(bK){return new t({$:3,$0:bK});};F.Updates=function(bK){return Y.MapTreeReduce(function(bL){return bL.NChanged();},H.Const(),H.Map2Unit,bK.DynNodes);};F.AppendTree=function(bK,bL){var bM;return bK===null?bL:bL===null?bK:(bM=new t({$:2,$0:bK,$1:bL}),(F.SetFlags(bM,F.Flags(bK)|F.Flags(bL)),bM));};F.EmptyAttr=function(){_1.$cctor();return _1.EmptyAttr;};F.Dynamic=function(bK,bL){return new t({$:1,$0:new bj.New(bK,bL)});};F.Insert=function(bK,bL){var bM,bN,bO;function bP(bQ){var bR,bS;while(true)if(!(bQ===null)){if(bQ!=null&&bQ.$==1)return bM.push(bQ.$0);else if(bQ!=null&&bQ.$==2){bR=bQ.$1;bS=bQ.$0;bP(bS);bQ=bR;}else return bQ!=null&&bQ.$==3?bQ.$0(bK):bQ!=null&&bQ.$==4?bN.push(bQ.$0):null;}else return null;}bM=[];bN=[];bP(bL);bO=bM.slice(0);return ba.New(bK,F.Flags(bL),bO,bN.length===0?null:{$:1,$0:function(bQ){w.iter(function(bR){bR(bQ);},bN);}});};F.SetFlags=function(bK,bL){bK.flags=bL;};F.Flags=function(bK){return bK!==null&&bK.hasOwnProperty("flags")?bK.flags:0;};F.HasExitAnim=function(bK){var bL;bL=2;return(bK.DynFlags&bL)===bL;};F.GetExitAnim=function(bK){return F.GetAnim(bK,function(bL,bM){return bL.NGetExitAnim(bM);});};F.HasEnterAnim=function(bK){var bL;bL=1;return(bK.DynFlags&bL)===bL;};F.GetEnterAnim=function(bK){return F.GetAnim(bK,function(bL,bM){return bL.NGetEnterAnim(bM);});};F.HasChangeAnim=function(bK){var bL;bL=4;return(bK.DynFlags&bL)===bL;};F.GetChangeAnim=function(bK){return F.GetAnim(bK,function(bL,bM){return bL.NGetChangeAnim(bM);});};F.GetAnim=function(bK,bL){return _7.Concat(y.map(function(bM){return bL(bM,bK.DynElem);},bK.DynNodes));};F.Sync=function(bK,bL){y.iter(function(bM){bM.NSync(bK);},bL.DynNodes);};G.ParseHTMLIntoFakeRoot=function(bK){var bL,bM,bN,bO,bP;function bQ(bR,bS){var bT;while(true)if(bS===0)return bR;else{bT=bS;bR=bR.lastChild;bS=bT-1;}}bL=self.document.createElement("div");return!G.rhtml().test(bK)?(bL.appendChild(self.document.createTextNode(bK)),bL):(bM=(bN=G.rtagName().exec(bK),P.Equals(bN,null)?"":y.get(bN,1).toLowerCase()),(bO=(bP=(G.wrapMap())[bM],bP?bP:G.defaultWrap()),(bL.innerHTML=bO[1]+bK.replace(G.rxhtmlTag(),"<$1></$2>")+bO[2],bQ(bL,bO[0]))));};G.rhtml=function(){bl.$cctor();return bl.rhtml;};G.wrapMap=function(){bl.$cctor();return bl.wrapMap;};G.defaultWrap=function(){bl.$cctor();return bl.defaultWrap;};G.rxhtmlTag=function(){bl.$cctor();return bl.rxhtmlTag;};G.rtagName=function(){bl.$cctor();return bl.rtagName;};G.IterSelector=function(bK,bL,bM){var bN,bO,bP;bN=bK.querySelectorAll(bL);for(bO=0,bP=bN.length-1;bO<=bP;bO++)bM(bN[bO]);};G.InsertAt=function(bK,bL,bM){var bN;if(!(bM.parentNode===bK&&bL===(bN=bM.nextSibling,P.Equals(bN,null)?null:bN)))bK.insertBefore(bM,bL);};G.RemoveNode=function(bK,bL){if(bL.parentNode===bK)bK.removeChild(bL);};H.Const=function(bK){var bL;bL=q.New({$:0,$0:bK});return function(){return bL;};};H.Sink=function(bK,bL){function bM(){q.WhenRun(bL(),bK,function(){bg.scheduler().Fork(bM);});}bg.scheduler().Fork(bM);};H.Map2Unit=function(bK,bL){return H.CreateLazy(function(){return q.Map2Unit(bK(),bL());});};H.CreateLazy=function(bK){var bL;bL={c:null,o:bK};return function(){var bM,bN;bM=bL.c;return bM===null?(bM=bL.o(),bL.c=bM,(bN=bM.s,bN!=null&&bN.$==0)?bL.o=null:q.WhenObsoleteRun(bM,function(){bL.c=null;}),bM):bM;};};H.Map=function(bK,bL){return H.CreateLazy(function(){return q.Map(bK,bL());});};I.Value=function(bK){return I.ValueWith(R.StringApply(),bK);};I.ValueWith=function(bK,bL){var bM;bM=bK(bL);return t.Append(F.Static(bM[0]),I.DynamicCustom(bM[1],bM[2]));};I.DynamicCustom=function(bK,bL){return F.Dynamic(bL,bK);};J.Get=function(bK){return bK instanceof a.Array?J.ArrayEnumerator(bK):P.Equals(typeof bK,"string")?J.StringEnumerator(bK):bK.GetEnumerator();};J.ArrayEnumerator=function(bK){return new K.New(0,null,function(bL){var bM;bM=bL.s;return bM<y.length(bK)&&(bL.c=y.get(bK,bM),bL.s=bM+1,true);},void 0);};J.StringEnumerator=function(bK){return new K.New(0,null,function(bL){var bM;bM=bL.s;return bM<bK.length&&(bL.c=bK[bM],bL.s=bM+1,true);},void 0);};J.Get0=function(bK){return bK instanceof a.Array?J.ArrayEnumerator(bK):P.Equals(typeof bK,"string")?J.StringEnumerator(bK):"GetEnumerator0"in bK?bK.GetEnumerator0():bK.GetEnumerator();};K=J.T=bG.Class({Dispose:function(){if(this.d)this.d(this);},MoveNext:function(){var bK;bK=this.n(this);this.e=bK?1:2;return bK;},Current:function(){return this.e===1?this.c:this.e===0?h.FailWith("Enumeration has not started. Call MoveNext."):h.FailWith("Enumeration already finished.");}},e,K);K.New=bG.Ctor(function(bK,bL,bM,bN){e.New.call(this);this.s=bK;this.c=bL;this.n=bM;this.d=bN;this.e=0;},K);y.get=function(bK,bL){y.checkBounds(bK,bL);return bK[bL];};y.length=function(bK){return bK.dims===2?bK.length*bK.length:bK.length;};y.checkBounds=function(bK,bL){if(bL<0||bL>=bK.length)h.FailWith("Index was outside the bounds of the array.");};y.set=function(bK,bL,bM){y.checkBounds(bK,bL);bK[bL]=bM;};O=N.Dictionary=bG.Class({set_Item:function(bK,bL){this.set(bK,bL);},ContainsKey:function(bK){var bL,bM;bL=this;bM=this.data[this.hash(bK)];return bM==null?false:y.exists(function(bN){return bL.equals.apply(null,[(h.KeyValue(bN))[0],bK]);},bM);},TryGetValue:function(bK,bL){var bM,bN,bO;bM=this;bN=this.data[this.hash(bK)];return bN==null?false:(bO=y.tryPick(function(bP){var bQ;bQ=h.KeyValue(bP);return bM.equals.apply(null,[bQ[0],bK])?{$:1,$0:bQ[1]}:null;},bN),bO!=null&&bO.$==1&&(bL.set(bO.$0),true));},RemoveKey:function(bK){return this.remove(bK);},Keys:function(){return new _6.New(this);},set:function(bK,bL){var bM,bN,bO,bP;bM=this;bN=this.hash(bK);bO=this.data[bN];if(bO==null){this.count=this.count+1;this.data[bN]=new a.Array({K:bK,V:bL});}else{bP=y.tryFindIndex(function(bQ){return bM.equals.apply(null,[(h.KeyValue(bQ))[0],bK]);},bO);bP==null?(this.count=this.count+1,bO.push({K:bK,V:bL})):bO[bP.$0]={K:bK,V:bL};}},remove:function(bK){var bL,bM,bN,bO;bL=this;bM=this.hash(bK);bN=this.data[bM];return bN==null?false:(bO=y.filter(function(bP){return!bL.equals.apply(null,[(h.KeyValue(bP))[0],bK]);},bN),y.length(bO)<bN.length&&(this.count=this.count-1,this.data[bM]=bO,true));},Item:function(bK){return this.get(bK);},GetEnumerator:function(){return J.Get0(y.concat(o.GetFieldValues(this.data)));},get:function(bK){var bL,bM;bL=this;bM=this.data[this.hash(bK)];return bM==null?_2.notPresent():y.pick(function(bN){var bO;bO=h.KeyValue(bN);return bL.equals.apply(null,[bO[0],bK])?{$:1,$0:bO[1]}:null;},bM);}},e,O);O.New$5=bG.Ctor(function(){O.New$6.call(this,[],P.Equals,P.Hash);},O);O.New$6=bG.Ctor(function(bK,bL,bM){var bN,bO;e.New.call(this);this.equals=bL;this.hash=bM;this.count=0;this.data=[];bN=J.Get(bK);try{while(bN.MoveNext()){bO=bN.Current();this.set(bO.K,bO.V);}}finally{if(typeof bN=="object"&&"Dispose"in bN)bN.Dispose();}},O);P.Equals=function(bK,bL){var bM,bN,bO,bP;if(bK===bL)return true;else{bM=typeof bK;if(bM=="object"){if(bK===null||bK===void 0||bL===null||bL===void 0||!P.Equals(typeof bL,"object"))return false;else if("Equals"in bK)return bK.Equals(bL);else if("Equals"in bL)return false;else if(bK instanceof a.Array&&bL instanceof a.Array)return P.arrayEquals(bK,bL);else if(bK instanceof a.Date&&bL instanceof a.Date)return P.dateEquals(bK,bL);else{bN=[true];for(var bQ in bK)if(function(bR){bN[0]=!bK.hasOwnProperty(bR)||bL.hasOwnProperty(bR)&&P.Equals(bK[bR],bL[bR]);return!bN[0];}(bQ))break;if(bN[0]){for(var bR in bL)if(function(bS){bN[0]=!bL.hasOwnProperty(bS)||bK.hasOwnProperty(bS);return!bN[0];}(bR))break;}return bN[0];}}else return bM=="function"&&("$Func"in bK?bK.$Func===bL.$Func&&bK.$Target===bL.$Target:"$Invokes"in bK&&"$Invokes"in bL&&P.arrayEquals(bK.$Invokes,bL.$Invokes));}};P.arrayEquals=function(bK,bL){var bM,bN;if(y.length(bK)===y.length(bL)){bM=true;bN=0;while(bM&&bN<y.length(bK)){!P.Equals(y.get(bK,bN),y.get(bL,bN))?bM=false:void 0;bN=bN+1;}return bM;}else return false;};P.dateEquals=function(bK,bL){return bK.getTime()===bL.getTime();};P.Hash=function(bK){var bL;bL=typeof bK;return bL=="function"?0:bL=="boolean"?bK?1:0:bL=="number"?bK:bL=="string"?P.hashString(bK):bL=="object"?bK==null?0:bK instanceof a.Array?P.hashArray(bK):P.hashObject(bK):0;};P.hashString=function(bK){var bL,bM,bN;if(bK===null)return 0;else{bL=5381;for(bM=0,bN=bK.length-1;bM<=bN;bM++)bL=P.hashMix(bL,bK[bM].charCodeAt());return bL;}};P.hashArray=function(bK){var bL,bM,bN;bL=-34948909;for(bM=0,bN=y.length(bK)-1;bM<=bN;bM++)bL=P.hashMix(bL,P.Hash(y.get(bK,bM)));return bL;};P.hashObject=function(bK){var bL,bM;if("GetHashCode"in bK)return bK.GetHashCode();else{bL=[0];for(var bN in bK)if(function(bO){bL[0]=P.hashMix(P.hashMix(bL[0],P.hashString(bO)),P.Hash(bK[bO]));return false;}(bN))break;return bL[0];}};P.hashMix=function(bK,bL){return(bK<<5)+bK+bL;};P.Compare=function(bK,bL){var bM,bN,bO,bP,bQ,bR;if(bK===bL)return 0;else{bN=typeof bK;switch(bN=="function"?1:bN=="boolean"?2:bN=="number"?2:bN=="string"?2:bN=="object"?3:0){case 0:return typeof bL=="undefined"?0:-1;case 1:return h.FailWith("Cannot compare function values.");case 2:return bK<bL?-1:1;case 3:if(bK===null)bO=-1;else if(bL===null)bO=1;else if("CompareTo"in bK)bO=bK.CompareTo(bL);else if("CompareTo0"in bK)bO=bK.CompareTo0(bL);else if(bK instanceof a.Array&&bL instanceof a.Array)bO=P.compareArrays(bK,bL);else if(bK instanceof a.Date&&bL instanceof a.Date)bO=P.compareDates(bK,bL);else{bP=[0];for(var bS in bK)if(function(bT){return!bK.hasOwnProperty(bT)?false:!bL.hasOwnProperty(bT)?(bP[0]=1,true):(bP[0]=P.Compare(bK[bT],bL[bT]),bP[0]!==0);}(bS))break;if(bP[0]===0){for(var bT in bL)if(function(bU){return!bL.hasOwnProperty(bU)?false:!bK.hasOwnProperty(bU)&&(bP[0]=-1,true);}(bT))break;}bO=bP[0];}return bO;}}};P.compareArrays=function(bK,bL){var bM,bN;if(y.length(bK)<y.length(bL))return -1;else if(y.length(bK)>y.length(bL))return 1;else{bM=0;bN=0;while(bM===0&&bN<y.length(bK)){bM=P.Compare(y.get(bK,bN),y.get(bL,bN));bN=bN+1;}return bM;}};P.compareDates=function(bK,bL){return P.Compare(bK.getTime(),bL.getTime());};q.Obsolete=function(bK){var bL,bM,bN,bO,bP;bM=bK.s;if(bM==null||(bM!=null&&bM.$==2?(bL=bM.$1,false):bM!=null&&bM.$==3?(bL=bM.$1,false):true))void 0;else{bK.s=null;for(bN=0,bO=y.length(bL)-1;bN<=bO;bN++){bP=y.get(bL,bN);if(typeof bP=="object")(function(bQ){q.Obsolete(bQ);}(bP));else bP();}}};q.New=function(bK){return{s:bK};};H=f.View=bG.Class({},null,H);Q.TryParseInt32=function(bK,bL){return Q.TryParse(bK,-2147483648,2147483647,bL);};R.StringApply=function(){_1.$cctor();return _1.StringApply;};R.ApplyValue=function(bK,bL,bM){var bN;function bO(bP,bQ){return bQ==null?null:bP(bQ.$0);}bN=null;return[function(bP){function bQ(){bM.UpdateMaybe(function(bR){var bS;bN=bK(bP);return bN!=null&&bN.$==1&&(!P.Equals(bN.$0,bR)&&(bS=[bN,bN.$0],true))?bS[0]:null;});}bP.addEventListener("change",bQ);bP.addEventListener("input",bQ);bP.addEventListener("keypress",bQ);},function(bP){var bQ;bQ=bL(bP);return function(bR){return bO(bQ,bR);};},H.Map(function(bP){var bQ;return bN!=null&&bN.$==1&&(P.Equals(bN.$0,bP)&&(bQ=bN.$0,true))?null:{$:1,$0:bP};},bM.get_View())];};R.StringSet=function(){_1.$cctor();return _1.StringSet;};R.StringGet=function(){_1.$cctor();return _1.StringGet;};R.DateTimeSetUnchecked=function(){_1.$cctor();return _1.DateTimeSetUnchecked;};R.DateTimeGetUnchecked=function(){_1.$cctor();return _1.DateTimeGetUnchecked;};R.FileApplyValue=function(bK,bL,bM){var bN;function bO(bP,bQ){return bQ==null?null:bP(bQ.$0);}bN=null;return[function(bP){bP.addEventListener("change",function(){bM.UpdateMaybe(function(bQ){var bR;bN=bK(bP);return bN!=null&&bN.$==1&&(bN.$0!==bQ&&(bR=[bN,bN.$0],true))?bR[0]:null;});});},function(bP){var bQ;bQ=bL(bP);return function(bR){return bO(bQ,bR);};},H.Map(function(bP){var bQ;return bN!=null&&bN.$==1&&(P.Equals(bN.$0,bP)&&(bQ=bN.$0,true))?null:{$:1,$0:bP};},bM.get_View())];};R.FileSetUnchecked=function(){_1.$cctor();return _1.FileSetUnchecked;};R.FileGetUnchecked=function(){_1.$cctor();return _1.FileGetUnchecked;};R.IntSetUnchecked=function(){_1.$cctor();return _1.IntSetUnchecked;};R.IntGetUnchecked=function(){_1.$cctor();return _1.IntGetUnchecked;};R.IntSetChecked=function(){_1.$cctor();return _1.IntSetChecked;};R.IntGetChecked=function(){_1.$cctor();return _1.IntGetChecked;};R.FloatSetUnchecked=function(){_1.$cctor();return _1.FloatSetUnchecked;};R.FloatGetUnchecked=function(){_1.$cctor();return _1.FloatGetUnchecked;};R.FloatSetChecked=function(){_1.$cctor();return _1.FloatSetChecked;};R.FloatGetChecked=function(){_1.$cctor();return _1.FloatGetChecked;};S.$cctor=function(){S.$cctor=a.ignore;S.LoadedTemplates=new O.New$5();S.LocalTemplatesLoaded=false;S.GlobalHoles=new O.New$5();S.TextHoleRE="\\${([^}]+)}";S.RenderedFullDocTemplate=null;};T=N.HashSet=bG.Class({SAdd:function(bK){return this.add(bK);},Contains:function(bK){var bL;bL=this.data[this.hash(bK)];return bL==null?false:this.arrContains(bK,bL);},add:function(bK){var bL,bM;bL=this.hash(bK);bM=this.data[bL];return bM==null?(this.data[bL]=[bK],this.count=this.count+1,true):this.arrContains(bK,bM)?false:(bM.push(bK),this.count=this.count+1,true);},arrContains:function(bK,bL){var bM,bN,bO,bP;bM=true;bN=0;bP=bL.length;while(bM&&bN<bP)if(this.equals.apply(null,[bL[bN],bK]))bM=false;else bN=bN+1;return!bM;},GetEnumerator:function(){return J.Get(bo.concat(this.data));},ExceptWith:function(bK){var bL;bL=J.Get(bK);try{while(bL.MoveNext())this.Remove(bL.Current());}finally{if(typeof bL=="object"&&"Dispose"in bL)bL.Dispose();}},Count:function(){return this.count;},IntersectWith:function(bK){var bL,bM,bN,bO,bP;bL=new T.New$4(bK,this.equals,this.hash);bM=bo.concat(this.data);for(bN=0,bO=bM.length-1;bN<=bO;bN++){bP=bM[bN];if(!bL.Contains(bP))this.Remove(bP);}},Remove:function(bK){var bL;bL=this.data[this.hash(bK)];return bL==null?false:this.arrRemove(bK,bL)&&(this.count=this.count-1,true);},CopyTo:function(bK,bL){var bM,bN,bO;bM=bo.concat(this.data);for(bN=0,bO=bM.length-1;bN<=bO;bN++)y.set(bK,bN+bL,bM[bN]);},arrRemove:function(bK,bL){var bM,bN,bO,bP;bM=true;bN=0;bP=bL.length;while(bM&&bN<bP)if(this.equals.apply(null,[bL[bN],bK])){bL.splice.apply(bL,[bN,1]);bM=false;}else bN=bN+1;return!bM;}},e,T);T.New$3=bG.Ctor(function(){T.New$4.call(this,[],P.Equals,P.Hash);},T);T.New$4=bG.Ctor(function(bK,bL,bM){var bN;e.New.call(this);this.equals=bL;this.hash=bM;this.data=[];this.count=0;bN=J.Get(bK);try{while(bN.MoveNext())this.add(bN.Current());}finally{if(typeof bN=="object"&&"Dispose"in bN)bN.Dispose();}},T);T.New$2=bG.Ctor(function(bK){T.New$4.call(this,bK,P.Equals,P.Hash);},T);U.LinkElement=function(bK,bL){U.InsertDoc(bK,bL,null);};U.InsertDoc=function(bK,bL,bM){var bN,bO,bP;while(true)if(bL!=null&&bL.$==1)return U.InsertNode(bK,bL.$0.El,bM);else if(bL!=null&&bL.$==2){bN=bL.$0;bN.Dirty=false;bL=bN.Current;}else if(bL==null)return bM;else if(bL!=null&&bL.$==4)return U.InsertNode(bK,bL.$0.Text,bM);else if(bL!=null&&bL.$==5)return U.InsertNode(bK,bL.$0,bM);else if(bL!=null&&bL.$==6)return y.foldBack(function(bQ,bR){return(((bG.Curried3(function(bS,bT,bU){return bT==null||bT.constructor===L?U.InsertDoc(bS,bT,bU):U.InsertNode(bS,bT,bU);}))(bK))(bQ))(bR);},bL.$0.Els,bM);else{bO=bL.$1;bP=bL.$0;bL=bP;bM=U.InsertDoc(bK,bO,bM);}};U.CreateRunState=function(bK,bL){return be.New(bf.get_Empty(),U.CreateElemNode(bK,F.EmptyAttr(),bL));};U.PerformAnimatedUpdate=function(bK,bL,bM){var bN;return _7.get_UseAnimations()?(bN=null,bg.Delay(function(){var bO,bP,bQ;bO=bf.FindAll(bM);bP=U.ComputeChangeAnim(bL,bO);bQ=U.ComputeEnterAnim(bL,bO);return bg.Bind(_7.Play(_7.Append(bP,U.ComputeExitAnim(bL,bO))),function(){return bg.Bind(U.SyncElemNodesNextFrame(bK,bL),function(){return bg.Bind(_7.Play(bQ),function(){bL.PreviousNodes=bO;return bg.Return(null);});});});})):U.SyncElemNodesNextFrame(bK,bL);};U.PerformSyncUpdate=function(bK,bL,bM){var bN;bN=bf.FindAll(bM);U.SyncElemNode(bK,bL.Top);bL.PreviousNodes=bN;};U.CreateElemNode=function(bK,bL,bM){var bN;U.LinkElement(bK,bM);bN=F.Insert(bK,bL);return Z.New(bN,bM,null,bK,D.Int(),bG.GetOptional(bN.OnAfterRender));};U.InsertNode=function(bK,bL,bM){G.InsertAt(bK,bM,bL);return bL;};U.SyncElemNodesNextFrame=function(bK,bL){function bM(bN){a.requestAnimationFrame(function(){U.SyncElemNode(bK,bL.Top);bN();});}return _8.BatchUpdatesEnabled()?bg.FromContinuations(function(bN,bO,bP){return bM.apply(null,[bN,bO,bP]);}):(U.SyncElemNode(bK,bL.Top),bg.Return(null));};U.ComputeExitAnim=function(bK,bL){return _7.Concat(y.map(function(bM){return F.GetExitAnim(bM.Attr);},bf.ToArray(bf.Except(bL,bf.Filter(function(bM){return F.HasExitAnim(bM.Attr);},bK.PreviousNodes)))));};U.ComputeEnterAnim=function(bK,bL){return _7.Concat(y.map(function(bM){return F.GetEnterAnim(bM.Attr);},bf.ToArray(bf.Except(bK.PreviousNodes,bf.Filter(function(bM){return F.HasEnterAnim(bM.Attr);},bL)))));};U.ComputeChangeAnim=function(bK,bL){var bM;function bN(bO){return F.HasChangeAnim(bO.Attr);}bM=function(bO){return bf.Filter(bN,bO);};return _7.Concat(y.map(function(bO){return F.GetChangeAnim(bO.Attr);},bf.ToArray(bf.Intersect(bM(bK.PreviousNodes),bM(bL)))));};U.SyncElemNode=function(bK,bL){!bK?U.SyncElement(bL):void 0;U.Sync(bL.Children);U.AfterRender(bL);};U.SyncElement=function(bK){function bL(bM){function bN(bO){var bP,bQ,bR,bS;while(true){if(bO!=null&&bO.$==0){bQ=bO.$1;bR=bO.$0;if(bN(bR))return true;else bO=bQ;}else if(bO!=null&&bO.$==2){bS=bO.$0;if(bS.Dirty)return true;else bO=bS.Current;}else return bO!=null&&bO.$==6&&(bP=bO.$0,bP.Dirty||y.exists(bL,bP.Holes));}}return bN(bM.Children);}F.Sync(bK.El,bK.Attr);if(bL(bK))U.DoSyncElement(bK);};U.Sync=function(bK){var bL,bM,bN,bO,bP;while(true){if(bK!=null&&bK.$==1)return U.SyncElemNode(false,bK.$0);else if(bK!=null&&bK.$==2){bN=bK.$0;bK=bN.Current;}else if(bK==null)return null;else if(bK!=null&&bK.$==5)return null;else if(bK!=null&&bK.$==4){bL=bK.$0;return bL.Dirty?(bL.Text.nodeValue=bL.Value,bL.Dirty=false):null;}else if(bK!=null&&bK.$==6){bM=bK.$0;y.iter(function(bQ){U.SyncElemNode(false,bQ);},bM.Holes);y.iter(function(bQ){F.Sync(bQ[0],bQ[1]);},bM.Attrs);return U.AfterRender(bM);}else{bO=bK.$1;bP=bK.$0;U.Sync(bP);bK=bO;}}};U.AfterRender=function(bK){var bL;bL=bG.GetOptional(bK.Render);if(bL!=null&&bL.$==1){bL.$0(bK.El);bG.SetOptional(bK,"Render",null);}};U.DoSyncElement=function(bK){var bL,bM,bN;function bO(bP,bQ){var bR,bS,bT,bU;while(true){if(bP!=null&&bP.$==1)return bP.$0.El;else if(bP!=null&&bP.$==2){bS=bP.$0;if(bS.Dirty){bS.Dirty=false;return U.InsertDoc(bL,bS.Current,bQ);}else bP=bS.Current;}else if(bP==null)return bQ;else if(bP!=null&&bP.$==4)return bP.$0.Text;else if(bP!=null&&bP.$==5)return bP.$0;else if(bP!=null&&bP.$==6){bR=bP.$0;bR.Dirty?bR.Dirty=false:void 0;return y.foldBack(function(bV,bW){return bV==null||bV.constructor===L?bO(bV,bW):bV;},bR.Els,bQ);}else{bT=bP.$1;bU=bP.$0;bP=bU;bQ=bO(bT,bQ);}}}bL=bK.El;by.Iter((bM=bK.El,function(bP){G.RemoveNode(bM,bP);}),by.Except(by.DocChildren(bK),by.Children(bK.El,bG.GetOptional(bK.Delimiters))));bO(bK.Children,(bN=bG.GetOptional(bK.Delimiters),bN!=null&&bN.$==1?bN.$0[1]:null));};V.$cctor=function(){V.$cctor=a.ignore;V.counter=0;};W=d.Random=bG.Class({Next$1:function(bK){return bK<0?h.FailWith("'maxValue' must be greater than zero."):bI.floor(bI.random()*bK);}},e,W);W.New=bG.Ctor(function(){e.New.call(this);},W);X=f.Elt=bG.Class({},u,X);X.New=function(bK,bL,bM){var bN,bO;bN=U.CreateElemNode(bK,bL,bM.docNode);bO=_.Create(bM.updates);return new X.New$1({$:1,$0:bN},H.Map2Unit(F.Updates(bN.Attr),bO.v),bK,bO);};X.New$1=bG.Ctor(function(bK,bL,bM,bN){u.New.call(this,bK,bL);this.docNode$1=bK;this.updates$1=bL;this.elt=bM;this.rvUpdates=bN;},X);Y.ofSeqNonCopying=function(bK){var bL,bM;if(bK instanceof a.Array)return bK;else if(bK instanceof x)return y.ofList(bK);else if(bK===null)return[];else{bL=[];bM=J.Get(bK);try{while(bM.MoveNext())bL.push(bM.Current());return bL;}finally{if(typeof bM=="object"&&"Dispose"in bM)bM.Dispose();}}};Y.TreeReduce=function(bK,bL,bM){var bN;function bO(bP){return function(bQ){var bR,bS;switch(bQ<=0?0:bQ===1?bP>=0&&bP<bN?1:(bR=bQ,2):(bR=bQ,2)){case 0:return bK;case 1:return y.get(bM,bP);case 2:bS=bQ/2>>0;return bL((bO(bP))(bS),(bO(bP+bS))(bQ-bS));}};}bN=y.length(bM);return(bO(0))(bN);};Y.MapTreeReduce=function(bK,bL,bM,bN){var bO;function bP(bQ){return function(bR){var bS,bT;switch(bR<=0?0:bR===1?bQ>=0&&bQ<bO?1:(bS=bR,2):(bS=bR,2)){case 0:return bL;case 1:return bK(y.get(bN,bQ));case 2:bT=bR/2>>0;return bM((bP(bQ))(bT),(bP(bQ+bT))(bR-bT));}};}bO=y.length(bN);return(bP(0))(bO);};Z=f.DocElemNode=bG.Class({Equals:function(bK){return this.ElKey===bK.ElKey;},GetHashCode:function(){return this.ElKey;}},null,Z);Z.New=function(bK,bL,bM,bN,bO,bP){var bQ;return new Z((bQ={Attr:bK,Children:bL,El:bN,ElKey:bO},(bG.SetOptional(bQ,"Delimiters",bM),bG.SetOptional(bQ,"Render",bP),bQ)));};_1.$cctor=function(){var bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX;_1.$cctor=a.ignore;_1.EmptyAttr=null;_1.BoolCheckedApply=function(bY){function bZ(b0,b1){return b1!=null&&b1.$==1?void(b0.checked=b1.$0):null;}return[function(b0){b0.addEventListener("change",function(){return bY.Get()!=b0.checked?bY.Set(b0.checked):null;});},function(b0){return function(b1){return bZ(b0,b1);};},H.Map(function(b0){return{$:1,$0:b0};},bY.get_View())];};_1.StringSet=function(bY){return function(bZ){bY.value=bZ;};};_1.StringGet=function(bY){return{$:1,$0:bY.value};};_1.StringApply=(bK=R.StringGet(),(bL=R.StringSet(),function(bY){return R.ApplyValue(bK,bL,bY);}));_1.DateTimeSetUnchecked=function(bY){return function(bZ){bY.value=(new a.Date(bZ)).toLocaleString();};};_1.DateTimeGetUnchecked=function(bY){var bZ,b0,b1,b2;bZ=bY.value;return bb.isBlank(bZ)?{$:1,$0:-8640000000000000}:(b0=(b1=0,[(b2=bk.TryParse(bZ),b2!=null&&b2.$==1&&(b1=b2.$0,true)),b1]),b0[0]?{$:1,$0:b0[1]}:null);};_1.DateTimeApplyUnchecked=(bM=R.DateTimeGetUnchecked(),(bN=R.DateTimeSetUnchecked(),function(bY){return R.ApplyValue(bM,bN,bY);}));_1.FileSetUnchecked=function(){return function(){return null;};};_1.FileGetUnchecked=function(bY){var bZ;bZ=bY.files;return{$:1,$0:y.ofSeq(w.delay(function(){return w.map(function(b0){return bZ.item(b0);},h.range(0,bZ.length-1));}))};};_1.FileApplyUnchecked=(bO=R.FileGetUnchecked(),(bP=R.FileSetUnchecked(),function(bY){return R.FileApplyValue(bO,bP,bY);}));_1.IntSetUnchecked=function(bY){return function(bZ){bY.value=bF(bZ);};};_1.IntGetUnchecked=function(bY){var bZ,b0;bZ=bY.value;return bb.isBlank(bZ)?{$:1,$0:0}:(b0=+bZ,b0!==b0>>0?null:{$:1,$0:b0});};_1.IntApplyUnchecked=(bQ=R.IntGetUnchecked(),(bR=R.IntSetUnchecked(),function(bY){return R.ApplyValue(bQ,bR,bY);}));_1.IntSetChecked=function(bY){return function(bZ){var b0;b0=bZ.get_Input();return bY.value!=b0?void(bY.value=b0):null;};};_1.IntGetChecked=function(bY){var bZ,b0,b1;bZ=bY.value;return{$:1,$0:bb.isBlank(bZ)?(bY.checkValidity?bY.checkValidity():true)?new bc({$:2,$0:bZ}):new bc({$:1,$0:bZ}):(b0=(b1=0,[Q.TryParseInt32(bZ,{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]),b0[0]?new bc({$:0,$0:b0[1],$1:bZ}):new bc({$:1,$0:bZ}))};};_1.IntApplyChecked=(bS=R.IntGetChecked(),(bT=R.IntSetChecked(),function(bY){return R.ApplyValue(bS,bT,bY);}));_1.FloatSetUnchecked=function(bY){return function(bZ){bY.value=bF(bZ);};};_1.FloatGetUnchecked=function(bY){var bZ,b0;bZ=bY.value;return bb.isBlank(bZ)?{$:1,$0:0}:(b0=+bZ,a.isNaN(b0)?null:{$:1,$0:b0});};_1.FloatApplyUnchecked=(bU=R.FloatGetUnchecked(),(bV=R.FloatSetUnchecked(),function(bY){return R.ApplyValue(bU,bV,bY);}));_1.FloatSetChecked=function(bY){return function(bZ){var b0;b0=bZ.get_Input();return bY.value!=b0?void(bY.value=b0):null;};};_1.FloatGetChecked=function(bY){var bZ,b0;bZ=bY.value;return{$:1,$0:bb.isBlank(bZ)?(bY.checkValidity?bY.checkValidity():true)?new bc({$:2,$0:bZ}):new bc({$:1,$0:bZ}):(b0=+bZ,a.isNaN(b0)?new bc({$:1,$0:bZ}):new bc({$:0,$0:b0,$1:bZ}))};};_1.FloatApplyChecked=(bW=R.FloatGetChecked(),(bX=R.FloatSetChecked(),function(bY){return R.ApplyValue(bW,bX,bY);}));};_2.notPresent=function(){throw new bq.New();};_4.convertTextNode=function(bK){var bL,bM,bN,bO,bP,bQ;bL=null;bM=0;bO=bK.textContent;bP=new a.RegExp(B.TextHoleRE(),"g");while(bL=bP.exec(bO),bL!==null){bK.parentNode.insertBefore(self.document.createTextNode(_5.string(bO,{$:1,$0:bM},{$:1,$0:bP.lastIndex-y.get(bL,0).length-1})),bK);bM=bP.lastIndex;bQ=self.document.createElement("span");bQ.setAttribute("ws-replace",y.get(bL,1).toLowerCase());bK.parentNode.insertBefore(bQ,bK);}bP.lastIndex=0;bK.textContent=_5.string(bO,{$:1,$0:bM},null);};_4.failNotLoaded=function(bK){bH.warn("Instantiating non-loaded template",bK);};_4.fillTextHole=function(bK,bL,bM){var bN;bN=bK.querySelector("[ws-replace]");return P.Equals(bN,null)?(bH.warn("Filling non-existent text hole",bM),null):(bN.parentNode.replaceChild(self.document.createTextNode(bL),bN),{$:1,$0:bN.getAttribute("ws-replace")});};_4.removeHolesExcept=function(bK,bL){function bM(bN){B.foreachNotPreserved(bK,"["+bN+"]",function(bO){if(!bL.Contains(bO.getAttribute(bN)))bO.removeAttribute(bN);});}bM("ws-attr");bM("ws-onafterrender");bM("ws-var");B.foreachNotPreserved(bK,"[ws-hole]",function(bN){if(!bL.Contains(bN.getAttribute("ws-hole"))){bN.removeAttribute("ws-hole");while(bN.hasChildNodes())bN.removeChild(bN.lastChild);}});B.foreachNotPreserved(bK,"[ws-replace]",function(bN){if(!bL.Contains(bN.getAttribute("ws-replace")))bN.parentNode.removeChild(bN);});B.foreachNotPreserved(bK,"[ws-on]",function(bN){bN.setAttribute("ws-on",s.concat(" ",y.filter(function(bO){return bL.Contains(y.get(s.SplitChars(bO,[":"],1),1));},s.SplitChars(bN.getAttribute("ws-on"),[" "],1))));});B.foreachNotPreserved(bK,"[ws-attr-holes]",function(bN){var bO,bP,bQ,bR,bS;bO=s.SplitChars(bN.getAttribute("ws-attr-holes"),[" "],1);for(bP=0,bQ=bO.length-1;bP<=bQ;bP++){bR=y.get(bO,bP);bN.setAttribute(bR,(bS=new a.RegExp(B.TextHoleRE(),"g"),bN.getAttribute(bR).replace(bS,function(bT,bU){return bL.Contains(bU)?bT:"";})));}});};_4.fillInstanceAttrs=function(bK,bL){var bM,bN,bO,bP,bQ;_4.convertAttrs(bL);bM=bL.nodeName.toLowerCase();bN=bK.querySelector("[ws-attr="+bM+"]");if(P.Equals(bN,null))bH.warn("Filling non-existent attr hole",bM);else{bN.removeAttribute("ws-attr");for(bO=0,bP=bL.attributes.length-1;bO<=bP;bO++){bQ=bL.attributes.item(bO);if(bQ.name=="class"&&bN.hasAttribute("class"))bN.setAttribute("class",bN.getAttribute("class")+" "+bQ.nodeValue);else bN.setAttribute(bQ.name,bQ.nodeValue);}}};_4.mapHoles=function(bK,bL){function bM(bN){B.foreachNotPreserved(bK,"["+bN+"]",function(bO){var bP,bQ;bP=(bQ=null,[bL.TryGetValue(bO.getAttribute(bN).toLowerCase(),{get:function(){return bQ;},set:function(bR){bQ=bR;}}),bQ]);if(bP[0])bO.setAttribute(bN,bP[1]);});}bM("ws-hole");bM("ws-replace");bM("ws-attr");bM("ws-onafterrender");bM("ws-var");B.foreachNotPreserved(bK,"[ws-on]",function(bN){bN.setAttribute("ws-on",s.concat(" ",y.map(function(bO){var bP,bQ,bR;bP=s.SplitChars(bO,[":"],1);bQ=(bR=null,[bL.TryGetValue(y.get(bP,1),{get:function(){return bR;},set:function(bS){bR=bS;}}),bR]);return bQ[0]?y.get(bP,0)+":"+bQ[1]:bO;},s.SplitChars(bN.getAttribute("ws-on"),[" "],1))));});B.foreachNotPreserved(bK,"[ws-attr-holes]",function(bN){var bO,bP,bQ;bO=s.SplitChars(bN.getAttribute("ws-attr-holes"),[" "],1);for(bP=0,bQ=bO.length-1;bP<=bQ;bP++)(function(){var bR;function bS(bT,bU){var bV;bV=h.KeyValue(bU);return bT.replace(new a.RegExp("\\${"+bV[0]+"}","ig"),"${"+bV[1]+"}");}bR=y.get(bO,bP);return bN.setAttribute(bR,(((bG.Curried3(w.fold))(bS))(bN.getAttribute(bR)))(bL));}());});};_4.fill=function(bK,bL,bM){while(true)if(bK.hasChildNodes())bM=bL.insertBefore(bK.lastChild,bM);else return null;};_4.convertAttrs=function(bK){var bM,bN,bO,bP,bQ,bR,bS,bT;function bL(bU){var bV;bV=bK.getAttribute(bU);if(bV==null);else bK.setAttribute(bU,bV.toLowerCase());}bM=bK.attributes;bN=[];bO=[];bP=[];for(bQ=0,bR=bM.length-1;bQ<=bR;bQ++){bS=bM.item(bQ);if(s.StartsWith(bS.nodeName,"ws-on")&&bS.nodeName!="ws-onafterrender"&&bS.nodeName!="ws-on"){bN.push(bS.nodeName);bO.push(_5.string(bS.nodeName,{$:1,$0:"ws-on".length},null)+":"+bS.nodeValue.toLowerCase());}else!s.StartsWith(bS.nodeName,"ws-")&&(new a.RegExp(B.TextHoleRE())).test(bS.nodeValue)?(bS.nodeValue=(bT=new a.RegExp(B.TextHoleRE(),"g"),bS.nodeValue.replace(bT,function(bU,bV){return"${"+bV.toLowerCase()+"}";})),bP.push(bS.nodeName)):void 0;}if(!(bO.length==0))bK.setAttribute("ws-on",s.concat(" ",bO));if(!(bP.length==0))bK.setAttribute("ws-attr-holes",s.concat(" ",bP));bL("ws-hole");bL("ws-replace");bL("ws-attr");bL("ws-onafterrender");bL("ws-var");y.iter(function(bU){bK.removeAttribute(bU);},bN);};_5.string=function(bK,bL,bM){var bN,bO;return bL==null?bM!=null&&bM.$==1?(bN=bM.$0,bN<0?"":bK.slice(0,bN+1)):"":bM==null?bK.slice(bL.$0):(bO=bM.$0,bO<0?"":bK.slice(bL.$0,bO+1));};w.insufficient=function(){return h.FailWith("The input sequence has an insufficient number of elements.");};w.nonNegative=function(){return h.FailWith("The input must be non-negative.");};_6=N.KeyCollection=bG.Class({GetEnumerator:function(){return J.Get(w.map(function(bK){return bK.K;},this.d));}},e,_6);_6.New=bG.Ctor(function(bK){e.New.call(this);this.d=bK;},_6);_7.get_UseAnimations=function(){return bh.UseAnimations();};_7.Play=function(bK){var bL;bL=null;return bg.Delay(function(){return bg.Bind(_7.Run(a.ignore,bh.Actions(bK)),function(){bh.Finalize(bK);return bg.Return(null);});});};_7.Append=function(bK,bL){return{$:0,$0:bn.Append(bK.$0,bL.$0)};};_7.Run=function(bK,bL){var bM;function bN(bO){function bP(bQ){return function(bR){var bS;bS=bR-bQ;bL.Compute(bS);bK();return bS<=bM?void a.requestAnimationFrame(function(bT){(bP(bQ))(bT);}):bO();};}a.requestAnimationFrame(function(bQ){(bP(bQ))(bQ);});}bM=bL.Duration;return bM===0?bg.Zero():bg.FromContinuations(function(bO,bP,bQ){return bN.apply(null,[bO,bP,bQ]);});};_7.Concat=function(bK){return{$:0,$0:bn.Concat(w.map(bh.List,bK))};};_7.get_Empty=function(){return{$:0,$0:bn.Empty()};};_8.BatchUpdatesEnabled=function(){bi.$cctor();return bi.BatchUpdatesEnabled;};_9.StartProcessor=function(bK){var bL;function bM(){var bN;bN=null;return bg.Delay(function(){return bg.Bind(bK,function(){var bO;bO=bL[0];return P.Equals(bO,1)?(bL[0]=0,bg.Zero()):P.Equals(bO,2)?(bL[0]=1,bM()):bg.Zero();});});}bL=[0];return function(){var bN;bN=bL[0];if(P.Equals(bN,0)){bL[0]=1;bg.Start(bM(),null);}else P.Equals(bN,1)?bL[0]=2:void 0;};};_=f.Updates=bG.Class({},null,_);_.Create=function(bK){var bL;bL=null;bL=_.New(bK,null,function(){var bM;bM=bL.s;return bM===null?(bM=q.Copy(bL.c()),bL.s=bM,q.WhenObsoleteRun(bM,function(){bL.s=null;}),bM):bM;});return bL;};_.New=function(bK,bL,bM){return new _({c:bK,s:bL,v:bM});};ba.New=function(bK,bL,bM,bN){var bO;bO={DynElem:bK,DynFlags:bL,DynNodes:bM};bG.SetOptional(bO,"OnAfterRender",bN);return bO;};bb.isBlank=function(bK){return s.forall(z.IsWhiteSpace,bK);};bc=f.CheckedInput=bG.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bc);be.New=function(bK,bL){return{PreviousNodes:bK,Top:bL};};bf.get_Empty=function(){return{$:0,$0:new T.New$3()};};bf.FindAll=function(bK){var bL;function bM(bP,bQ){var bR,bS,bT,bU,bV;while(true)switch(bP){case 0:if(bQ!=null&&bQ.$==0){bS=bQ.$1;bT=bQ.$0;bM(0,bT);bQ=bS;}else if(bQ!=null&&bQ.$==1){bU=bQ.$0;bQ=bU;bP=1;}else if(bQ!=null&&bQ.$==2){bV=bQ.$0;bQ=bV.Current;}else return bQ!=null&&bQ.$==6?(bR=bQ.$0.Holes,(function(bW){return function(bX){y.iter(bW,bX);};}(bO))(bR)):null;break;case 1:bL.push(bQ);bQ=bQ.Children;bP=0;break;}}function bN(bP){return bM(0,bP);}function bO(bP){return bM(1,bP);}bL=[];bN(bK);return{$:0,$0:new T.New$2(bL)};};bf.Filter=function(bK,bL){return{$:0,$0:bw.Filter(bK,bL.$0)};};bf.Except=function(bK,bL){return{$:0,$0:bw.Except(bK.$0,bL.$0)};};bf.ToArray=function(bK){return bw.ToArray(bK.$0);};bf.Intersect=function(bK,bL){return{$:0,$0:bw.Intersect(bK.$0,bL.$0)};};bg.Delay=function(bK){return function(bL){try{(bK(null))(bL);}catch(bM){bL.k({$:1,$0:bM});}};};bg.Bind=function(bK,bL){return bg.checkCancel(function(bM){bK(bt.New(function(bN){var bO;if(bN.$==0){bO=bN.$0;bg.scheduler().Fork(function(){try{(bL(bO))(bM);}catch(bP){bM.k({$:1,$0:bP});}});}else bg.scheduler().Fork(function(){bM.k(bN);});},bM.ct));});};bg.Zero=function(){bu.$cctor();return bu.Zero;};bg.Start=function(bK,bL){var bM,bN;bM=(bN=(bg.defCTS())[0],bL==null?bN:bL.$0);bg.scheduler().Fork(function(){if(!bM.c)bK(bt.New(function(bO){if(bO.$==1)bg.UncaughtAsyncError(bO.$0);},bM));});};bg.Return=function(bK){return function(bL){bL.k({$:0,$0:bK});};};bg.scheduler=function(){bu.$cctor();return bu.scheduler;};bg.checkCancel=function(bK){return function(bL){if(bL.ct.c)bg.cancel(bL);else bK(bL);};};bg.defCTS=function(){bu.$cctor();return bu.defCTS;};bg.UncaughtAsyncError=function(bK){bH.log("WebSharper: Uncaught asynchronous exception",bK);};bg.FromContinuations=function(bK){return function(bL){var bM;function bN(bO){if(bM[0])h.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bM[0]=true;bg.scheduler().Fork(bO);}}bM=[false];bK(function(bO){bN(function(){bL.k({$:0,$0:bO});});},function(bO){bN(function(){bL.k({$:1,$0:bO});});},function(bO){bN(function(){bL.k({$:2,$0:bO});});});};};bg.cancel=function(bK){bK.k({$:2,$0:new bz.New(bK.ct)});};bh.UseAnimations=function(){bm.$cctor();return bm.UseAnimations;};bh.Actions=function(bK){return bh.ConcatActions(y.choose(function(bL){return bL.$==1?{$:1,$0:bL.$0}:null;},bn.ToArray(bK.$0)));};bh.Finalize=function(bK){y.iter(function(bL){if(bL.$==0)bL.$0();},bn.ToArray(bK.$0));};bh.ConcatActions=function(bK){var bL,bM,bN,bO;bL=Y.ofSeqNonCopying(bK);bM=y.length(bL);return bM===0?bh.Const():bM===1?y.get(bL,0):(bN=w.max(w.map(function(bP){return bP.Duration;},bL)),(bO=y.map(function(bP){return bh.Prolong(bN,bP);},bL),bh.Def(bN,function(bP){y.iter(function(bQ){bQ.Compute(bP);},bO);})));};bh.List=function(bK){return bK.$0;};bh.Const=function(bK){return bh.Def(0,function(){return bK;});};bh.Def=function(bK,bL){return{Compute:bL,Duration:bK};};bh.Prolong=function(bK,bL){var bM,bN,bO;bM=bL.Compute;bN=bL.Duration;bO=bA.Create(function(){return bL.Compute(bL.Duration);});return{Compute:function(bP){return bP>=bN?bO.f():bM(bP);},Duration:bK};};bi.$cctor=function(){bi.$cctor=a.ignore;bi.BatchUpdatesEnabled=true;};bj=f.DynamicAttrNode=bG.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bK){return _7.get_Empty();},NGetEnterAnim:function(bK){return _7.get_Empty();},NGetChangeAnim:function(bK){return _7.get_Empty();},NSync:function(bK){if(this.dirty){(this.push(bK))(this.value);this.dirty=false;}}},e,bj);bj.New=bG.Ctor(function(bK,bL){var bM;bM=this;e.New.call(this);this.push=bL;this.value=void 0;this.dirty=false;this.updates=H.Map(function(bN){bM.value=bN;bM.dirty=true;},bK);},bj);bk.TryParse=function(bK){var bL;bL=bJ.parse(bK);return a.isNaN(bL)?null:{$:1,$0:bL};};Q.TryParse=function(bK,bL,bM,bN){var bO,bP;bO=+bK;bP=bO===bO-bO%1&&bO>=bL&&bO<=bM;if(bP)bN.set(bO);return bP;};bl.$cctor=function(){var bK;bl.$cctor=a.ignore;bl.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bl.rtagName=new a.RegExp("<([\\w:]+)");bl.rhtml=new a.RegExp("<|&#?\\w+;");bl.wrapMap=(bK=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:bK,tbody:bK,tfoot:bK,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bl.defaultWrap=[0,"",""];};bm.$cctor=function(){bm.$cctor=a.ignore;bm.CubicInOut=bs.Custom(function(bK){var bL;bL=bK*bK;return 3*bL-2*(bL*bK);});bm.UseAnimations=true;};bn.Append=function(bK,bL){return bK.$==0?bL:bL.$==0?bK:{$:2,$0:bK,$1:bL};};bn.ToArray=function(bK){var bL;function bM(bN){var bO,bP;while(true)if(bN.$==1)return bL.push(bN.$0);else if(bN.$==2){bO=bN.$1;bP=bN.$0;bM(bP);bN=bO;}else return bN.$==3?y.iter(function(bQ){bL.push(bQ);},bN.$0):null;}bL=[];bM(bK);return bL.slice(0);};bn.Concat=function(bK){var bL;bL=Y.ofSeqNonCopying(bK);return Y.TreeReduce(bn.Empty(),bn.Append,bL);};bn.Empty=function(){bB.$cctor();return bB.Empty;};bo.concat=function(bK){var bL,bM;bL=[];for(var bN in bK)bL.push.apply(bL,bK[bN]);return bL;};bq=d.KeyNotFoundException=bG.Class({},bp,bq);bq.New=bG.Ctor(function(){bq.New$1.call(this,"The given key was not present in the dictionary.");},bq);bq.New$1=bG.Ctor(function(bK){this.message=bK;L.setPrototypeOf(this,bq.prototype);},bq);br=bg.Scheduler=bG.Class({Fork:function(bK){var bL;bL=this;this.robin.push(bK);if(this.idle){this.idle=false;a.setTimeout(function(){bL.tick();},0);}},tick:function(){var bK,bL,bM;bL=this;bM=bJ.now();bK=true;while(bK)if(this.robin.length===0){this.idle=true;bK=false;}else{(this.robin.shift())();bJ.now()-bM>40?(a.setTimeout(function(){bL.tick();},0),bK=false):void 0;}}},e,br);br.New=bG.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},br);bs=f.Easing=bG.Class({},e,bs);bs.Custom=function(bK){return new bs.New(bK);};bs.New=bG.Ctor(function(bK){e.New.call(this);this.transformTime=bK;},bs);bt.New=function(bK,bL){return{k:bK,ct:bL};};bu.$cctor=function(){bu.$cctor=a.ignore;bu.noneCT=bv.New(false,[]);bu.scheduler=new br.New();bu.defCTS=[new bx.New()];bu.Zero=bg.Return();bu.GetCT=function(bK){bK.k({$:0,$0:bK.ct});};};bv.New=function(bK,bL){return{c:bK,r:bL};};bw.Filter=function(bK,bL){return new T.New$2(y.filter(bK,bw.ToArray(bL)));};bw.Except=function(bK,bL){var bM;bM=new T.New$2(bw.ToArray(bL));bM.ExceptWith(bw.ToArray(bK));return bM;};bw.ToArray=function(bK){var bL;bL=y.create(bK.Count(),void 0);bK.CopyTo(bL,0);return bL;};bw.Intersect=function(bK,bL){var bM;bM=new T.New$2(bw.ToArray(bK));bM.IntersectWith(bw.ToArray(bL));return bM;};bx=d.CancellationTokenSource=bG.Class({},e,bx);bx.New=bG.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bx);by.Children=function(bK,bL){var bM,bN,bO;if(bL!=null&&bL.$==1){bO=[];bM=bL.$0[0].nextSibling;while(bM!==bL.$0[1]){bO.push(bM);bM=bM.nextSibling;}return{$:0,$0:bO};}else return{$:0,$0:y.init(bK.childNodes.length,(bN=bK.childNodes,function(bP){return bN[bP];}))};};by.Except=function(bK,bL){var bM;bM=bK.$0;return{$:0,$0:y.filter(function(bN){return y.forall(function(bO){return!(bN===bO);},bM);},bL.$0)};};by.Iter=function(bK,bL){y.iter(bK,bL.$0);};by.DocChildren=function(bK){var bL;function bM(bN){var bO,bP,bQ,bR;while(true){if(bN!=null&&bN.$==2){bP=bN.$0;bN=bP.Current;}else if(bN!=null&&bN.$==1)return bL.push(bN.$0.El);else if(bN==null)return null;else if(bN!=null&&bN.$==5)return bL.push(bN.$0);else if(bN!=null&&bN.$==4)return bL.push(bN.$0.Text);else if(bN!=null&&bN.$==6){bO=bN.$0.Els;return(function(bS){return function(bT){y.iter(bS,bT);};}(function(bS){if(bS==null||bS.constructor===L)bM(bS);else bL.push(bS);}))(bO);}else{bQ=bN.$1;bR=bN.$0;bM(bR);bN=bQ;}}}bL=[];bM(bK.Children);return{$:0,$0:Y.ofSeqNonCopying(bL)};};bz=d.OperationCanceledException=bG.Class({},bp,bz);bz.New=bG.Ctor(function(bK){bz.New$1.call(this,"The operation was canceled.",null,bK);},bz);bz.New$1=bG.Ctor(function(bK,bL,bM){this.message=bK;this.inner=bL;L.setPrototypeOf(this,bz.prototype);this.ct=bM;},bz);bA.Create=function(bK){return bE.New(false,bK,bA.forceLazy);};bA.forceLazy=function(){var bK;bK=this.v();this.c=true;this.v=bK;this.f=bA.cachedLazy;return bK;};bA.cachedLazy=function(){return this.v;};bB.$cctor=function(){bB.$cctor=a.ignore;bB.Empty={$:0};};bC.Clear=function(bK){bK.splice(0,y.length(bK));};bE.New=function(bK,bL,bM){return{c:bK,v:bL,f:bM};};bG.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
